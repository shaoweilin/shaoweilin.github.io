---
layout: post
title: Motivic relative information
---

So far, our definition of relative information studies the divergence between real-valued measures. In this post, we will explore motivic measures which take values more generally in some ring $$R$$, and have some fun applying motivic relative information to zeta functions.

This post is a continuation from our [series](https://shaoweilin.github.io/motivic-information-path-integrals-and-spiking-networks/) on spiking networks, path integrals and motivic information.

## How do we define measures which are not real-valued?

When studying logical objects (described by logical formulas possibly involving existential or universal quantifiers) such as algebraic varieties or quantum events, we could be interested in more general measurements such as Euler characteristics or path integrals. These measurements could have values in some polynomial ring. Loosely we will call them _measures_, even though they do not satisfy the classical definition in measure theory.

We may also be interested in finding a universal measure in the sense that all other measures (such as probabilities, polynomials and counts) factor through this measure. Lastly, we may want to compute the divergence or relative information between measures which are not real-valued.

In classical measure theory, a measure space $$(\Omega, \mathcal{C}, P)$$ contains a collection $$\mathcal{C}$$ of objects that we are measuring and a map $$P : \mathcal{C} \rightarrow R$$ where $$R$$ is the ring of real numbers. The measure $$P$$ satisfies the axioms

1.  Non-negativity. $$P(E) \geq 0$$ for all $$E \in \mathcal{C};$$
2.  Null empty set. $$P(\emptyset) = 0;$$
3.  Countable additivity. $$P(\cup_{i=1}^\infty E_i) = \sum_{i=1}^\infty P(E_i)$$ for countable collection of pairwise disjoint sets.

The second axiom follows from the third axiom if at least one set in $$\mathcal{C}$$ has finite measure.

When generalizing the above definition to measures which are non real-valued, there are two additional conditions that we may want to consider. The first is that the measure should be invariant under equivalence between the objects. The second is that the collection $$\mathcal{C}$$ should include products of its objects, e.g. the higher-dimensional Cartesian product of one-dimensional intervals on the real line.

Moreover, as a result of the axioms, generalized measures on collections $$\mathcal{C}$$ of objects will factor through some universal ring of values, known as a Grothendieck ring [[S09]](#ref-S09), [[H05]](#ref-H05). Suppose we have a category $$\mathcal{C}$$ or universe of objects with some kind of equivalence $$X \sim Y$$, products $$X \times Y$$, coproducts $$X \oplus Y$$ and a terminal object $$*$$. Suppose also that $$\times$$ distributes over $$\oplus$$, i.e. $$X \times (Y \oplus Z) = X \times Y \oplus X \times Z.$$ We consider the _Grothendieck ring_ $$K_0(\mathcal{C})$$ freely-generated by the objects modulo the equivalence $$=$$ generated by the relations

1.  _Congruence_. $$[X] = [Y]$$ if $$X \sim Y;$$
2.  _Coproduct_. $$[X \oplus Y] = [X] + [Y];$$
3.  _Product_. $$[X \times Y] = [X] \times [Y].$$

Therefore, a measure on $$\mathcal{C}$$ with values in $$R$$ may be thought of as a map $$\mathcal{C} \rightarrow K_0(\mathcal{C}) \rightarrow R.$$ The ring homomorphism $$\mu : K_0(\mathcal{C}) \rightarrow R$$ will be called a _motivic measure_.

The coproduct rule for Grothendieck rings mirrors the additivity rule for classical measures. We can extend the coproduct rule to countable disjoint unions if we consider a completion of the Grothendieck ring. The non-negativity rule for classical measures does not have an analog for Grothendieck rings unless we consider valuation rings. Alternatively, we can work with thermodynamic distributions and exponential families which are discussed in the next section.

In many categories, the coproduct is just the disjoint union and the product is the Cartesian product. The essence of these Grothendieck rings therefore depends largely on the equivalence $$\sim$$ between the objects. For example, if we consider the universe of polygons with $$\sim$$ being congruence by rotation, reflection and translation, then we get the classical polygon scissor ring. If we consider the universe of finite sets with $$\sim$$ being bijective equivalence, then we get the counting scissor ring which is isomorphic to the integers $$\mathbb{Z}$$. If we consider the category $$\mathcal{V}_k$$ of algebraic varieties over a field $$k$$ with $$X \sim Y$$ being isomorphism of varieties, then we get the Grothendieck ring of varieties $$K_0(\mathcal{V}_k)$$.

It should also be possible to extend these Grothendieck rings to universes of types, with respect to equivalences, dependent sums and dependent products over these types.

It may seem advantageous to work directly in the Grothendieck ring $$K_0(\mathcal{C})$$ rather than with the motivic measure $$\mu : K_0(\mathcal{C}) \rightarrow R.$$ However, the Grothendieck ring is often not well-understood. For example, it was only discovered fairly recently that the Grothendieck ring of varieties $$K_0(\mathcal{V}_k)$$ has zero-divisors [[P02]](#ref-P02). On the other hand, a motivic measure lets us tease out a particular aspect of the Grothendieck ring.

## How do we define the entropy of a variety with respect to its zeta function?

We follow the work of [[M19]](#ref-M19) and rewrite her results in our notation.

Recall that in thermodynamics, given a system with finitely many states, the Boltzmann distribution defines the probability of a state $$i$$ as

$$P(z,i) = \displaystyle \frac{e^{-z \varepsilon(i)}}{Z(z)}$$

where $$\varepsilon(i)$$ is the state energy, $$z$$ is the (scaled) inverse temperature and

$$Z(z) = \sum_i e^{-z \varepsilon(i)}$$

is the partition function.

The entropy of the Boltzmann distribution is then

$$\begin{array}{rl} H(z) &= - \sum_i P(z,i) \log P(z,i) \\ & \\ &= \log Z + z \,Z^{-1} \sum_i \varepsilon(i) e^{-z\varepsilon(i)} \\ & \\ &= \log Z - z\, Z^{-1} \frac{dZ}{dz} \\ & \\ &= \left(1- z \frac{d}{dz} \right) \log Z(z). \end{array}$$

Therefore, the entropy is completely determined by how the partition function varies with temperature.

Given two Boltzmann distributions

$$P(z,i) =\displaystyle \frac{e^{-z \varepsilon_P(i)}}{Z_P(z)}, \quad Q(z,i) = \displaystyle \frac{e^{-z \varepsilon_Q(i)}}{Z_Q(z)},$$

the relative information to $$Q$$ from $$P$$ is

$$\begin{array}{rl} I_{Q\Vert P}(z) &=\displaystyle \sum_i Q(z,i) \log \frac{Q(z,i)}{P(z,i)}\\ & \\ &=\log\displaystyle \frac{Z_P}{Z_Q} -z\, \displaystyle Z_Q^{-1} \sum_i (\varepsilon_Q(i)-\varepsilon_P(i)) e^{-z\varepsilon_Q(i)}. \end{array}$$

We will now apply these constructions to algebraic geometry.

Given a zeta function of the form

$$Z(z) = \displaystyle \sum_{i \in \mathcal{C}} e^{-z\varepsilon(i)}$$

where the sum is over some set $$\mathcal{C}$$ of objects, we define a distribution $$P$$ over $$\mathcal{C}$$ by

$$P(z,i) = \displaystyle \frac{e^{-z \varepsilon(i)}}{Z(z)}.$$

For example, the [Hasse-Weil zeta function](https://shaoweilin.github.io/zeta-functions-mellin-transforms-and-the-gelfand-leray-form/) of a variety $$V$$ over a finite field $$\mathbb{F}_q$$ may be written as

$$Z_V(z) = \displaystyle \sum_{\alpha \in \mathcal{C}_V} e^{-z \deg(\alpha) \log q},$$

where $$\mathcal{C}_V$$ is the set of effective zero-cycles of $$V$$. The entropy of the associated distribution

$$P_V(z,\alpha) = \displaystyle \frac{q^{-z \deg(\alpha)}}{Z_V(z)}$$

is therefore

$$H_V(z) = \left(1- z \frac{d}{dz} \right) \log Z_V(z).$$

[Recall](https://shaoweilin.github.io/zeta-functions-mellin-transforms-and-the-gelfand-leray-form/) that

$$\log Z_V(z) = \displaystyle \sum_{m \geq 1} \frac{\#V(\mathbb{F}_{q^m})}{m}q^{-zm} $$

where $$\#V(\mathbb{F}_{q^m})$$ is the number of points of $$V$$ over the field extension $$\mathbb{F}_{q^m}.$$ Therefore,

$$H_V(z) = \displaystyle \sum_{m \geq 1} \left(\frac{1}{m}+z\log q \right) \#V(\mathbb{F}_{q^m})q^{-zm}.$$

## How do we extend relative information to motivic measures?

Suppose that we have a zeta function of the form

$$Z(z) = \displaystyle \sum_{i \in \mathcal{C}} m_i e^{-z\varepsilon(i)}$$

with coefficients $$m_i$$ such that $$Z(z)$$ has an analytic continuation to the whole complex plane and $$Z(z)$$ is holomorphic at $$z=0$$.

We define the distribution

$$Q(z,i) = \displaystyle \frac{m_i e^{-z \varepsilon(i)}}{Z(z)}$$

and consider the relative information to $$Q(z)$$ from $$Q(0)$$

$$\begin{array}{rl} I_{Q(z)\Vert Q(0)}(z) &=\displaystyle \sum_i Q(z,i) \log \frac{Q(z,i)}{Q(0,i)} \\ & \\ &=\log Z(0) - \log Z(z) + \displaystyle \sum_i \frac{m_i e^{-z \varepsilon(i)}}{Z(z)} \log \frac{m_i e^{-z \varepsilon(i)}}{m_i } \\ & \\ &= \log Z(0) - \left(1- z \frac{d}{dz} \right) \log Z(z).\end{array}$$

The distribution $$Q(0)$$ occurs when the inverse temperature is zero, so it is the limiting distribution at infinite temperature. Note that the final term above is just the entropy of the zeta function when all the coefficients $$m_i$$ are equal to one.

Another representation of the Hasse-Weil zeta function is

$$Z_V(z) = \displaystyle \sum_{n \geq 0} \#(S^n V) q^{-zn}$$

where $$S^n V$$ is the $$n$$-fold symmetric product of $$V$$. To this representation, we may associate the distribution

$$Q_V(z,n) = \displaystyle \frac{\#(S^n V) e^{-z n \log q}}{Z_V(z)}$$

and the relative information to $$Q_V(z)$$ from $$Q_V(0)$$ is

$$I_{Q_V(z)\Vert Q_V(0)}(z) = \log Z_V(0) - H_V(z)$$

where the final term above is the entropy defined previously. It is not difficult to see that we will get the same relative information if we define the distribution $$Q_V$$ to be over the effective zero cycles rather than over the nonnegative integers.

The Hasse-Weil zeta function was generalized by Kapranov for a motivic measure $$\mu: K_0(\mathcal{V}_k) \rightarrow R$$ to

$$Z_{\mu,V}(t) =\displaystyle \sum_{n \geq 0} \mu(S^n V) t^n.$$

The zeta function takes value in the formal power series ring $$R[[t]]$$, or more precisely, the big Witt ring $$W(R)$$. To the Kapranov zeta function, we associate the distribution

$$Q_V(t,n) = \displaystyle \frac{\mu(S^n V) t^n}{Z_{\mu,V}(t)}$$

where a substitution $$z = -\log t$$ was made. The relative information to $$Q_V(t)$$ from $$Q_V(1)$$ is therefore

$$I_{Q_V(t)\Vert Q_V(1)}(t) = \log Z_V(1) - \left(1- (t \log t) \frac{d}{dt} \right) \log Z_V(t).$$

Note that the different measures discussed above should not be confused with each other:

1.  the measure $$Q_V : \mathbb{Z}_{\geq 0} \rightarrow W(R)$$;
2.  the motivic measure $$\mu: K_0(\mathcal{V}_k) \rightarrow R$$;
3.  the motivic measure $$Z_{\mu}:\mathcal{V}_k \rightarrow W(R)$$ which maps varieties $$V$$ to some formal power series.

## What is the relative information of morphisms between algebraic varieties?

We consider the relative information of proper morphisms and flat morphisms as described in §4.5-§4.7 of [[M19]](#ref-M19).

First, for each variety $$V$$, we define $$P_V(t)$$ be the distribution on $$\mathcal{C}_V$$ given by

$$P_V(t,\alpha) = \displaystyle \frac{t^{ \deg(\alpha)}}{Z_V(t)}$$

where $$Z_V(t) = \sum_\alpha t^{\deg(\alpha)}$$ is the Hasse-Weil zeta function.

Now, given a proper morphism $$f: X \rightarrow Y$$ of algebraic varieties, consider the resulting pushforward $$f_*:\mathcal{C}_X \rightarrow \mathcal{C}_Y$$ of effective zero-cycles. Then, both $$P_X(t)$$ and $$P_Y(t) \circ f_*$$ will be distributions on $$\mathcal{C}_X$$, with

$$P_Y(t) \circ f_*(\alpha) = \displaystyle \frac{t^{\deg(f_*(\alpha))}}{Z_Y(t)} = \frac{t^{\deg(\alpha)}}{Z_Y(t)}$$

because $$\deg(f_*(\alpha)) = \deg(\alpha)$$ for proper morphisms $$f$$.

We consider the relative information to $$P_X(t)$$ from $$P_Y(t) \circ f_*,$$ i.e.

$$I_{P_X \Vert P_Y \circ f_*}(t) = \displaystyle \sum_{\alpha \in \mathcal{C}_X} P_X(t,\alpha) \log \frac{P_X(t,\alpha)}{P_Y(t,f_*(\alpha))}.$$

Using the formula

$$I_{Q\Vert P}(z) =\log\displaystyle \frac{Z_P}{Z_Q} -z\, \displaystyle Z_Q^{-1} \sum_i (\varepsilon_Q(i)-\varepsilon_P(i)) e^{-z\varepsilon_Q(i)},$$

the latter term vanishes so

$$I_{P_X \Vert P_Y \circ f_*}(t) = \displaystyle \log \frac{Z_Y(t)}{Z_X(t)}.$$

Next, given a flat morphism $$f: X \rightarrow Y$$ of algebraic varieties, consider the resulting pullback $$f^*:\mathcal{C}_Y \rightarrow \mathcal{C}_X$$ of effective zero-cycles. Then, both $$P_Y(t)$$ and $$P_X(t) \circ f^*$$ will be distributions on $$\mathcal{C}_Y$$.

We consider the relative information to $$P_Y(t)$$ from $$P_X(t) \circ f^*,$$ i.e.

$$I_{P_Y \Vert P_X \circ f^*}(t) = \displaystyle \sum_{\alpha \in \mathcal{C}_Y} P_Y(t,\alpha) \log \frac{P_Y(t,\alpha)}{P_X(t,f^*(\alpha))}.$$

In the special case where $$f:X\rightarrow Y$$ is a finite flat surjective morphism of smooth quasi-projective varieties with constant degree $$\delta =\deg f,$$ we have

$$\deg(f^*(\alpha)) = \delta \deg(\alpha)$$

so the relative information simplifies to

$$I_{P_Y \Vert P_X \circ f^*}(t) =\displaystyle \log \frac{Z_X(t)}{Z_Y(t)} - (\delta-1) (t \log t) \frac{d}{dt} \log Z_Y(t).$$

## References

<a id="ref-H05"></a>[[H05]](#ref-H05) Hales, Thomas. "What is motivic measure?." _Bulletin of the American Mathematical Society_ 42, no. 2 (2005): 119-135.

<a id="ref-M19"></a>[[M19]](#ref-M19) Marcolli, Matilde. "Motivic information." Bollettino dell'Unione Matematica Italiana 12, no. 1-2 (2019): 19-41.

<a id="ref-P02"></a>[[P02]](#ref-P02) Poonen, Bjorn. "The Grothendieck ring of varieties is not a domain." _arXiv preprint math/0204306_ (2002).

<a id="ref-S09"></a>[[S09]](#ref-S09) Scanlon, Thomas. "[Motivic Integration: An outsider’s tutorial](https://math.berkeley.edu/~scanlon/papers/scanlon_durham_motivic_integration_outsiders_tutorial.pdf)," 2009.